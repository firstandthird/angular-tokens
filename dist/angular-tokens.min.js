
/*!
 * angular-tokens - Angular directive for the tokens plugin
 * v0.1.0
 * http://github.com/firstandthird/angular-tokens/
 * copyright First + Third 2014
 * MIT License
*/
!function(){angular.module("ftTokens",[]).directive("tokens",[function(){return{restrict:"A",scope:{tokensSuggestions:"=",tokensSelected:"=ngModel",tokensAdd:"&",tokensRemove:"&"},link:function(a,b){var c=$(b),d=a.tokensAdd||angular.noop,e=a.tokensRemove||angular.noop;c.tokens({source:a.tokensSuggestions||[],initValue:a.tokensSelected}),a.tokens=c.data("tokens"),a.syncing=!1;var f=function(){a.syncing=!0;for(var b=a.tokens.getValue().slice(0),c=0,d=b.length;d>c;c++){var e=b[c];a.tokens.removeValue(e)}a.syncing=!1},g=function(){a.syncing=!0;for(var b=0,c=a.tokensSelected.length;c>b;b++)a.tokens.addValue(a.tokensSelected[b]);a.syncing=!1};c.on("remove",function(b,c){a.syncing||a.$apply(function(){var d=a.tokensSelected.indexOf(c);a.tokensSelected.splice(d,1),e.call(this,b,c)})}),c.on("add",function(b,c){a.syncing||a.$apply(function(){a.tokensSelected.push(c),d.call(this,b,c)})}),a.$watch("tokensSelected",function(b,c){c!==a.tokens.getValue()&&(f(),g())},!0),a.$watch("tokensSuggestions",function(){a.tokens.source=a.tokensSuggestions||[]},!0)}}}])}();