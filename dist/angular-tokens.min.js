
/*!
 * angular-tokens - Angular directive for the tokens plugin
 * v0.2.0
 * http://github.com/firstandthird/angular-tokens/
 * copyright First + Third 2014
 * MIT License
*/
!function(){angular.module("ftTokens",[]).directive("tokens",[function(){return{restrict:"A",scope:{tokensSuggestions:"=",tokensSelected:"=ngModel",tokensAdd:"&",tokensRemove:"&",tokensValidate:"&"},link:function(a,b,c){var d=$(b),e=a.tokensAdd||angular.noop,f=a.tokensRemove||angular.noop,g=a.tokensValidate||angular.noop;d.tokens({source:a.tokensSuggestions||[],initValue:a.tokensSelected}),a.tokens=d.data("tokens"),a.syncing=!1;var h=function(){a.syncing=!0;for(var b=a.tokens.getValue().slice(0),c=0,d=b.length;d>c;c++){var e=b[c];a.tokens.removeValue(e)}a.syncing=!1},i=function(){a.syncing=!0;for(var b=0,c=a.tokensSelected.length;c>b;b++)a.tokens.addValue(a.tokensSelected[b]);a.syncing=!1};d.on("remove",function(b,c){a.syncing||a.$apply(function(){var d=a.tokensSelected.indexOf(c);a.tokensSelected.splice(d,1),f.call(this,b,c)})}),d.on("add",function(b,c){a.syncing||a.$apply(function(){a.tokensSelected.push(c),e.call(this,b,c)})}),a.$watch("tokensSelected",function(b,c){c!==a.tokens.getValue()&&(h(),i())},!0),a.$watch("tokensSuggestions",function(){a.tokens.source=a.tokensSuggestions||[]},!0),c.tokensValidate&&(a.tokens.validate=function(a){return g({query:a})})}}}])}();